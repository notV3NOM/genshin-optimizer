"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[954],{60747:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Pe});var n=a(98283),r=a(31981),i=a(12761);function l(t,e=10){return c(t,e)}function o(t,e=10){return c(t,-e)}function c(t,e=10){const{r:a,g:n,b:r,a:l}=t;return{r:(0,i.re)(a+e,0,255),g:(0,i.re)(n+e,0,255),b:(0,i.re)(r+e,0,255),a:l}}function s(t,e){const a=t.width,n=t.height;let{x1:r=0,x2:l=a,y1:o=0,y2:c=n}=e;r=(0,i.re)(r,0,a),l=(0,i.re)(l,0,a),o=(0,i.re)(o,0,n),c=(0,i.re)(c,0,n),o>=c&&(console.warn(`trying to crop with y1:${o} y2:${c}, with src height ${n}.`),o=0,c=n),r>=l&&(console.warn(`trying to crop with x1:${r} x2:${l}, with src width ${a}.`),r=0,l=a);return t.getContext("2d",{willReadFrequently:!0}).getImageData(r,o,l-r,c-o)}const d=t=>new Promise((e=>{const a=new Image;a.onload=({target:t})=>e(function(t){const e=document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});return e.width=t.width,e.height=t.height,a.drawImage(t,0,0,t.width,t.height),a.getImageData(0,0,t.width,t.height)}(t)),a.src=t}));function h(t){const e=document.createElement("canvas");return e.width=t.width,e.height=t.height,e.getContext("2d").putImageData(t,0,0),e}function u(t,e=!1,a=128){const n=t.data;for(let r=0;r<n.length;r+=4){const t=(n[r]+n[r+1]+n[r+2])/3>a!==e?255:0;n[r]=n[r+1]=n[r+2]=t}return t}function f(t){const e=t.width,a=t.height,n=t.data,r=[-1,0,1,-2,0,2,-1,0,1],i=[-1,-2,-1,0,0,0,1,2,1],l=new Uint8ClampedArray(n);for(let o=1;o<a-1;o++)for(let t=1;t<e-1;t++){let a=0,c=0;for(let l=0;l<3;l++)for(let s=0;s<3;s++){const d=4*((o+l-1)*e+(t+s-1)),h=r[3*l+s],u=i[3*l+s];a+=n[d]*h,c+=n[d]*u}const s=Math.sqrt(a*a+c*c),d=4*(o*e+t);l[d]=s,l[d+1]=s,l[d+2]=s}return new ImageData(l,e,a)}function m(t,e){if(0===e)return[t,new ImageData(t.width,1)];const a=document.createElement("canvas");a.width=t.width,a.height=t.height;a.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0);return[s(a,{y1:0,y2:e}),s(a,{y1:e,y2:t.height})]}function Z(t,e,a,n=!0,r=[0,1]){const l=t.height,o=t.width,c=t.data,s=n?o:l,[d,h]=r,u=s*d,f=s*h;return Array.from({length:s},((t,r)=>{if(r<u||r>f)return 0;let s=0,d=0;for(let h=0;h<(n?l:o);h++){const t=n?g(r,h,o):g(h,r,o),[l,u,f]=[c[t],c[t+1],c[t+2]];(0,i.uh)(l,e.r,a.r)&&(0,i.uh)(u,e.g,a.g)&&(0,i.uh)(f,e.b,a.b)?d++:(d>s&&(s=d),d=0)}return d>s&&(s=d),s}))}function g(t,e,a){return e*(4*a)+4*t}const p={r:255,g:231,b:186},y={r:255,g:137,b:117},b={r:255,g:204,b:50};var v=a(72718),x=a(24691),w=a(74155),S=a(47462);const k={hp:"HP",hp_:"HP",atk:"ATK",atk_:"ATK",def:"DEF",def_:"DEF",eleMas:"Elemental Mastery",enerRech_:"Energy Recharge",critRate_:"Crit Rate",critDMG_:"Crit DMG",heal_:"Healing Bonus"};Object.entries({physical:"Physical",anemo:"Anemo",geo:"Geo",electro:"Electro",hydro:"Hydro",pyro:"Pyro",cryo:"Cryo",dendro:"Dendro"}).forEach((([t,e])=>{k[`${t}_dmg_`]=`${e} DMG Bonus`}));const C={flower:"Flower of Life",plume:"Plume of Death",sands:"Sands of Eon",goblet:"Goblet of Eonothem",circlet:"Circlet of Logos"};var B=a(52903);function K(t,e,a,n,l,o,c,s=!1){const d={lock:b(s,"Lock",(t=>t?"Locked":"Unlocked"))};c&&(d.location=b(c,"Location",(t=>t)));const h=e.size?[...e]:["EmblemOfSeveredFate"];let u=-1,f=[{setKey:"EmblemOfSeveredFate",rarity:5,level:0,slotKey:"flower",mainStatKey:"hp",substats:[],location:null!=c?c:"",lock:s}];const m=(0,i.K8)(r.$W,(a=>{let r=0;if(e.size){r+=[...e].reduce(((t,e)=>t+(v.G2.art.data[e].rarities.includes(a)?1:0)),0)/e.size}if(t.has(a)&&r++,n.length){r+=n.reduce(((t,e)=>t+((0,w.UW)(e.key,e.value,a).length?1:0)),0)/n.length*2}return r}));for(const x of r.Ex)for(const t of r.yh[x]){const n=(0,i.bf)(t),r="%"===n?1:0,d="%"===n?.1:1,Z=(a.has(x)?1:0)+(l.has(t)?1:0),g=o.filter((e=>"%"!==e.unit||"%"===(0,i.bf)(t))).map((t=>t.mainStatValue));for(const[a,i]of Object.entries(m)){const n=parseInt(a),l=h.filter((t=>v.G2.art.data[t].rarities.includes(n))),o=Z+i;if(!(o+2<u)){for(const a of g){const i=(0,w.HD)(n,t),h=Math.max(0,i.findIndex((t=>t+d>=a))),m=o+(i[h].toFixed(r)===a.toFixed(r)?1:0);for(const a of l){const r=m+(e.has(a)?1:0);r>=u&&(r>u&&(f=[]),u=r,f.push({setKey:a,rarity:n,level:h,slotKey:x,mainStatKey:t,substats:[],location:null!=c?c:"",lock:s}))}}if(o>=u){const a=0;for(const r of l){const i=o+(e.has(r)?1:0);i>u&&(f=[]),u=i,f.push({setKey:r,rarity:n,level:a,slotKey:x,mainStatKey:t,substats:[],location:null!=c?c:"",lock:s})}}}}}const Z={setKey:new Set,rarity:new Set,level:new Set,slotKey:new Set,mainStatKey:new Set,mainStatVal:new Set},g=f[0],p=(0,w.Bv)(g.mainStatKey,g.rarity,g.level);g.substats=n.filter(((t,e)=>t.key!==g.mainStatKey&&n.slice(0,e).every((e=>e.key!==t.key))));for(let r=g.substats.length;r<4;r++)g.substats.push({key:"",value:0});for(const r of f)Z.setKey.add(r.setKey),Z.rarity.add(r.rarity),Z.level.add(r.level),Z.slotKey.add(r.slotKey),Z.mainStatKey.add(r.mainStatKey);function y(t,e,a){return(0,B.BX)(B.HY,{children:["Unknown ",e," : Set to"," ",(0,B.tZ)(S._w,{color:"error",children:a(t)})]})}function b(t,e,a){return(0,B.BX)(B.HY,{children:["Detected ",e," ",(0,B.tZ)(S._w,{color:"success",children:a(t)})]})}function C(t,e,a){return(0,B.BX)(B.HY,{children:["Inferred ",e," ",(0,B.tZ)(S._w,{color:"warning",children:a(t)})]})}function K(t,e,a,n){const r=new Set([...Z[t]].filter((t=>e.has(t)))),i=g[t];r.size>1?d[t]=function(t,e,a,n){return(0,B.BX)(B.HY,{children:["Ambiguous ",a," ",(0,B.tZ)(S._w,{color:"error",children:n(t)})," : May also be"," ",e.filter((e=>e!==t)).map(((t,e)=>(0,B.BX)(B.HY,{children:[(0,B.tZ)("b",{children:e>0?"/":""}),(0,B.tZ)(S._w,{color:"warning",children:n(t)})]})))]})}(i,[...e],a,n):1===r.size?d[t]=b(i,a,n):Z[t].size>1?d[t]=y(i,a,n):d[t]=C(i,a,n)}K("setKey",e,"Set",(t=>(0,B.tZ)(x.C3,{setKey:t}))),K("rarity",t,"Rarity",(t=>(0,B.BX)(B.HY,{children:[t," ",1!==t?"Stars":"Star"]}))),K("slotKey",a,"Slot",(t=>(0,B.tZ)(x.cN,{slotKey:t}))),K("mainStatKey",l,"Main Stat",(t=>(0,B.tZ)("span",{children:k[t]}))),d.substats=(0,B.tZ)(B.HY,{children:g.substats.filter((t=>""!==t.key)).map(((t,e)=>(0,B.tZ)("div",{children:b(t,"Sub Stat",(t=>(0,B.BX)(B.HY,{children:[k[t.key],"+",(0,w.Jj)(t.value,(0,i.bf)(t.key)),(0,i.bf)(t.key)]})))},e)))});const P=t=>(0,B.BX)(B.HY,{children:[(0,w.Jj)(t,(0,i.bf)(g.mainStatKey)),(0,i.bf)(g.mainStatKey)]}),R="%"===(0,i.bf)(g.mainStatKey)?1:0;return o.find((t=>t.mainStatValue.toFixed(R)===p.toFixed(R)))?l.has(g.mainStatKey)?(d.level=b(g.level,"Level",(t=>"+"+t)),d.mainStatVal=b(p,"Main Stat value",P)):(d.level=C(g.level,"Level",(t=>"+"+t)),d.mainStatVal=C(p,"Main Stat value",P)):(d.level=y(g.level,"Level",(t=>"+"+t)),d.mainStatVal=y(p,"Main Stat value",P)),[g,d]}function P(t){const e=Math.min(...t.map((([,t])=>t))),a=t.filter((([,t])=>t===e)).map((([t])=>t));return new Set(a)}function R(t){const e={};return t=function(t,e){const a=f(t);e["Edge Detection Full Screen"]=h(a).toDataURL();const n=u(new ImageData(new Uint8ClampedArray(a.data),a.width,a.height)),{topLeft:r,bottomRight:i}=function(t){const e=t.width,a=t.height,n=t.data;let r=0,i={topLeft:{x:0,y:0},bottomRight:{x:0,y:0}};function l(t,a){return 255===n[4*(a*e+t)]}function o(t,n){let r=t,i=t,o=n,c=n;for(;r>0&&l(r-1,n);)r--;for(;i<e-1&&l(i+1,n);)i++;for(;o>0&&l(t,o-1);)o--;for(;c<a-1&&l(t,c+1);)c++;return{topLeft:{x:r,y:o},bottomRight:{x:i,y:c}}}for(let c=0;c<a;c++)for(let t=0;t<e;t++)if(l(t,c)){const e=o(t,c),a=(e.bottomRight.x-e.topLeft.x+1)*(e.bottomRight.y-e.topLeft.y+1);a>r&&(r=a,i=e)}return i}(n),l=document.createElement("canvas"),o=l.getContext("2d"),c=i.x-r.x+1,s=i.y-r.y+1;l.width=c,l.height=s,o.drawImage(h(t),r.x,r.y,c,s,0,0,c,s);const d=o.getImageData(0,0,c,s);return e["Largest Rectangle"]=l.toDataURL(),d}(function(t){const e=t.width,a=t.height;if(e>a)return t;const n=Math.max(e,a)+20,r=Math.max(e,a)+20,i=document.createElement("canvas");i.width=n,i.height=r;const l=i.getContext("2d"),o=Math.floor((n-e)/2),c=Math.floor((r-a)/2);return l.fillStyle="black",l.fillRect(0,0,n,r),l.putImageData(t,o,c),l.getImageData(0,0,n,r)}(t),e),{artifactImageData:t,debugImgs:e}}const A=.2;async function D(t,e){const{artifactImageData:a,debugImgs:n}=R(t),r=f(u(new ImageData(new Uint8ClampedArray(a.data),a.width,a.height),!1,200)),i=function(t,e=80){const a=t.width,n=t.height,r=t.data;let i=0;for(let l=20;l<n;l++){let t=0;for(let e=0;e<a;e++)255===r[4*(l*a+e)]&&t++;if(t/a*100>e){i=l;break}}return i}(r),[l,o]=m(a,i),[c,d]=m(l,A*l.height),Z=function(t,e=5,a=50){const n=t.width,r=t.height,i=t.data;let l=-1,o=0;for(let c=0;c<r;c+=e){let t=0;for(let l=0;l<e&&c+l<r;l++){let e=0;for(let t=0;t<n;t++){const r=4*((c+l)*n+t),o=i[r];i[r+1]-(o+i[r+2])/2>a&&e++}t+=e}t>o&&(o=t,l=c)}return l}(o,20),[g,p]=m(o,Z-c.height/4),[y,b]=m(p,p.height-c.height);n["Edge Detection"]=h(r).toDataURL(),n["Header Card"]=h(l).toDataURL(),n["White Card"]=h(o).toDataURL(),n["Artifact Name Card"]=h(c).toDataURL(),n["Artifact Main Stat Card"]=h(d).toDataURL(),n["Artifact Substats"]=h(g).toDataURL(),n["Artifact Set & Location"]=h(p).toDataURL(),n["Artifact Set"]=h(y).toDataURL(),n["Artifact Location"]=h(b).toDataURL();const v=[{name:"ArtifactName",start:0,end:1,crop:1,ocr:!0,invert:!0,bw:!0,cropRight:!1,threshold:160,scale:!1,scaleFactor:1,extractBox:!0,extractColor:"black",padding:10,image:c},{name:"ArtifactSlot",start:0,end:.2,crop:.8,ocr:!0,invert:!0,bw:!0,cropRight:!1,threshold:160,scale:!1,scaleFactor:1,extractBox:!0,extractColor:"black",padding:10,image:d},{name:"ArtifactMainStat",start:.4,end:.55,crop:.5,ocr:!0,invert:!0,bw:!0,cropRight:!1,threshold:150,scale:!0,scaleFactor:2,extractBox:!0,extractColor:"black",padding:10,image:d},{name:"ArtifactMainStatValue",start:.525,end:.775,crop:.5,ocr:!0,invert:!0,bw:!0,cropRight:!1,threshold:160,scale:!0,scaleFactor:2,extractBox:!0,extractColor:"black",padding:10,image:d},{name:"ArtifactRarity",start:.775,end:.95,crop:.4,ocr:!1,invert:!0,bw:!1,cropRight:!1,threshold:128,scale:!1,scaleFactor:1,extractBox:!1,extractColor:"white",padding:10,image:d},{name:"ArtifactLevel",start:.03,end:.275,crop:.2,ocr:!0,invert:!0,bw:!0,cropRight:!1,threshold:128,scale:!0,scaleFactor:2,extractBox:!0,extractColor:"white",padding:0,image:g},{name:"ArtifactLock",start:.03,end:.275,crop:.8,ocr:!1,invert:!0,bw:!1,cropRight:!0,threshold:128,scale:!1,scaleFactor:1,extractBox:!1,extractColor:"white",padding:0,image:g},{name:"ArtifactSubstats",start:.275,end:1,crop:1,ocr:!0,invert:!1,bw:!0,cropRight:!1,threshold:160,scale:!1,scaleFactor:1,extractBox:!0,extractColor:"black",padding:10,image:g},{name:"ArtifactSet",start:0,end:1,crop:1,ocr:!0,invert:!1,bw:!0,cropRight:!1,threshold:160,scale:!1,scaleFactor:1,extractBox:!0,extractColor:"black",padding:10,image:y},{name:"ArtifactLocation",start:0,end:1,crop:1,ocr:!0,invert:!1,bw:!0,cropRight:!1,threshold:160,scale:!1,scaleFactor:1,extractBox:!0,extractColor:"black",padding:10,image:b}],x=v.map(((t,a)=>{const r=t.image.height,i=t.image.width,l=s(h(t.image),{x1:t.cropRight?Math.floor(t.crop*i):5,x2:t.cropRight?i:Math.floor(t.crop*i),y1:Math.floor(t.start*r),y2:Math.floor(t.end*r)}),o=t.bw?u(l,t.invert,t.threshold):l,c=t.extractBox?function(t,e,a){const n=t.width,r=t.height,i=t.data;let l=n,o=r,c=0,s=0;const d="white"===e?[255,255,255]:[0,0,0];for(let m=0;m<r;m++)for(let t=0;t<n;t++){const e=4*(m*n+t);i[e]===d[0]&&i[e+1]===d[1]&&i[e+2]===d[2]&&(l=Math.min(l,t),o=Math.min(o,m),c=Math.max(c,t),s=Math.max(s,m))}l=Math.max(0,l-a),o=Math.max(0,o-a),c=Math.min(n-1,c+a),s=Math.min(r-1,s+a);const h=Math.abs(c-l+1),u=Math.abs(s-o+1),f=new ImageData(h,u);for(let m=o;m<=s;m++)for(let t=l;t<=c;t++){const e=4*(m*n+t),a=4*((m-o)*h+(t-l));f.data[a]=i[e],f.data[a+1]=i[e+1],f.data[a+2]=i[e+2],f.data[a+3]=i[e+3]}return f}(o,t.extractColor,t.padding):o,d=t.scale?function(t,e){const a=document.createElement("canvas");a.width=Math.floor(t.width*e),a.height=Math.floor(t.height*e);const n=a.getContext("2d");return n.drawImage(h(t),0,0,t.width,t.height,0,0,a.width,a.height),n.getImageData(0,0,a.width,a.height)}(c,t.scaleFactor):c;return n[v[a].name]=h(d).toDataURL(),{name:t.name,textPromise:t.ocr?e(d):Promise.resolve([""])}})),w=await Promise.all(x.map((async t=>{const e=(await t.textPromise).map((t=>t.replace(/\n/g,"")));return{name:t.name,text:e.length?e:[""]}}))),S={};return w.forEach((t=>{S[t.name]=t.text})),{prediction:S,debugImgs:n,artifactImageData:a}}async function M(t,e,a=!0){const{f:n,fName:c}=t,u=await(f=n,new Promise((t=>{const e=new FileReader;e.onloadend=({target:e})=>t(e.result),e.readAsDataURL(f)})));var f;const m=await d(u),{prediction:v,debugImgs:x,artifactImageData:w}=await D(m,e);a&&console.log("OCR Prediction",v);const S=Z(w,o(p),l(p),!1).some((t=>t>.5*w.width))||v.ArtifactLocation.some((t=>t.toLowerCase().includes("equipped"))),B=function(t,e,a,n=!0){const r=t.height,l=t.width,o=t.data;return Array.from({length:n?l:r},((t,c)=>{let s=0;for(let f=0;f<(n?r:l);f++){const t=n?g(c,f,l):g(f,c,l),[r,m,Z]=[o[t],o[t+1],o[t+2]];d={r,g:m,b:Z},h=e,u=a,(0,i.uh)(d.r,h.r,u.r)&&(0,i.uh)(d.g,h.g,u.g)&&(0,i.uh)(d.b,h.b,u.b)&&s++}var d,h,u;return s}))}(await d(x.ArtifactLock),o(y),l(y)),R=B.filter((t=>t>5)).length>5,A=function(t){const e=Z(t,o(b),l(b),!1),[a,n]=function(t,e=.7,a=3){const n=Math.max(...t)*e,r=t.length;let i=-a;for(let o=0;o<r;o++){const e=t[o]>n;if(e){if(e&&i<0)i=o;else if(e&&o-i>a)break}else i=-a}i<0&&(i=0);let l=r-1+a;for(let o=r-1;o>=0;o--){const e=t[o]>n;if(e){if(e&&l>r-1)l=o;else if(e&&l-o>a)break}else l=r-1+a}return l>r-1&&(l=r-1),[i,l]}(e,.3),r=Z(s(h(t),{y1:a,y2:n}),o(b),l(b)),c=.5*Math.max(...r);let d=0,u=!1;for(let i=0;i<r.length;i++)r[i]>c?u||(d++,u=!0):u&&(u=!1);return(0,i.re)(d,1,5)}(await d(x.ArtifactRarity)),[M,X]=K(new Set([A]),function(t){const e=[];for(const n of t)for(const t of r.Gt)e.push([t,(0,i.Ay)(n.replace(/\W/g,""),t)]);const a=P(e);return console.log("Best Match for Set ",a),a}([v.ArtifactSet[0]]),function(t){const e=[];for(const n of t)for(const t of r.Ex)e.push([t,(0,i.Ay)(n.replace(/\W/g,""),C[t].replace(/\W/g,""))]);const a=P(e);return console.log("Best Match for Slot ",a),a}(v.ArtifactSlot),function(t){const e=[];for(let a of t)a=a.replace(/^[\W]+/,"").replace(/\n/,""),r._m.forEach((t=>{const n=k[t],r=("%"===(0,i.bf)(t)?new RegExp(n+"\\s*\\+\\s*(\\d+[\\.|,]+\\d)%","im"):new RegExp(n+"\\s*\\+\\s*(\\d+,\\d+|\\d+)($|\\s)","im")).exec(a);r&&e.push({key:t,value:parseFloat(r[1].replace(/,/g,".").replace(/\.{2,}/g,"."))})}));return console.log("Best Match for Substats ",e.slice(0,4)),e.slice(0,4)}(v.ArtifactSubstats),function(t){const e=[];for(const o of t)for(const t of r.rW){var a,n;const r=null==(a=k[t])?void 0:a.toLowerCase();r.length<=3?o.toLowerCase().includes(r)&&e.push([t,0]):e.push([t,(0,i.Ay)(o.replace(/\W/g,""),(null!=(n=k[t])?n:"").replace(/\W/g,""))])}const l=P(e);return console.log("Best Match for Main Stat ",l),l}(v.ArtifactMainStat),function(t){const e=[];for(let a of t){a=a.replace(/[^0-9%,.]/g,"1");let t=/(\d+[,|\\.]+\d)%/,n=t.exec(a);n&&e.push({mainStatValue:parseFloat(n[1].replace(/,/g,".").replace(/\.{2,}/g,".")),unit:"%"}),t=/(\d+[,|\\.]\d{3}|\d{2,3})/,n=t.exec(a),n&&e.push({mainStatValue:parseInt(n[1].replace(/[,|\\.]+/g,""))})}return console.log("Best Match for Main Stat Value ",e),e}(v.ArtifactMainStatValue),S?function(t){const e=[];for(let n of t){if(!n)continue;const t=n.indexOf(":");if(-1!==t&&(n=n.slice(t+1)),n)for(const a of r.vp)e.push([a,(0,i.Ay)(n.replace(/\W/g,""),a)])}e.push(["Traveler",8]);const[a]=P(e);return console.log("Best Match for Equipped ",a),a}(v.ArtifactLocation):"",R);return{fileName:c,imageURL:h(w).toDataURL(),artifact:M,texts:X,debugImgs:x}}class ScanningQueue{constructor(t,e=!1){this.debug=void 0,this.textsFromImage=void 0,this.processed=[],this.outstanding=[],this.scanning=[],this.callback=()=>{},this.textsFromImage=t,this.debug=e}addFiles(t){this.outstanding.push(...t),this.processQueue()}processQueue(){const t=Math.min(16-this.processed.length-this.scanning.length,3-this.scanning.length,this.outstanding.length);t&&this.outstanding.splice(0,t).map((t=>{const e=M(t,this.textsFromImage,this.debug);this.scanning.push(e),e.then((t=>{const a=this.scanning.indexOf(e);-1!==a&&(this.scanning.splice(a,1),this.processed.push(t),this.processQueue())}))})),this.callCB()}callCB(){this.callback({processedNum:this.processed.length,outstandingNum:this.outstanding.length,scanningNum:this.scanning.length})}shiftProcessed(){const t=this.processed.shift();return t&&this.processQueue(),t}clearQueue(){this.processed=[],this.outstanding=[],this.scanning=[],this.callCB()}}var X=a(36226),E=a(75927),I=a(93994),L=a(72550),F=a(67651),U=a(73673),G=a(92252),O=a(32510),N=a(58130),$=a(85219),W=a(16549),H=a(65992),_=a(47746),j=a(86432),z=a(42523),V=a(7671),T=a(41075),Y=a(67550),q=a(80551),Q=a(83249),J=a(79906),tt=a(62197),et=a(94380),at=a(38162),nt=a(72841),rt=a(107),it=a(33927),lt=a(2784),ot=a(11141),ct=a(23485),st=a(36674);let dt,ht=t=>t;const ut=["rarity","onChange","filter"];function ft(t){let{rarity:e,onChange:a,filter:r}=t,i=(0,n.Z)(t,ut);const{t:l}=(0,ot.$G)("artifact");return(0,B.tZ)(ct.Z,Object.assign({},i,{title:e?(0,B.tZ)(st.q,{stars:e,inline:!0}):l(dt||(dt=ht`editor.rarity`)),color:e?"success":"primary",children:[5,4,3].map((t=>(0,B.tZ)(et.Z,{disabled:!r(t),onClick:()=>a(t),children:(0,B.tZ)(st.q,{stars:t,inline:!0})},t)))}))}var mt=a(47712),Zt=a(83993),gt=a(82056),pt=a(56961),yt=a(79199);let bt,vt=t=>t;const xt=["slotKey","onChange","hasUnselect"];function wt(t){let{slotKey:e="",onChange:a,hasUnselect:i=!1}=t,l=(0,n.Z)(t,xt);const{t:o}=(0,ot.$G)(["artifact","ui"]);return(0,B.BX)(ct.Z,Object.assign({title:o(e?`artifact:slotName:${e}`:"artifact:slot"),color:e?"success":"primary",startIcon:e?(0,B.tZ)(yt.Z,{slotKey:e}):void 0},l,{children:[i&&(0,B.BX)(et.Z,{selected:""===e,disabled:""===e,onClick:()=>a(""),children:[(0,B.tZ)(Zt.Z,{children:(0,B.tZ)(O.Z,{})}),(0,B.tZ)(gt.Z,{children:o(bt||(bt=vt`ui:unselect`))})]}),i&&(0,B.tZ)(pt.Z,{}),r.Ex.map((t=>(0,B.BX)(et.Z,{selected:e===t,disabled:e===t,onClick:()=>a(t),children:[(0,B.tZ)(Zt.Z,{children:(0,B.tZ)(yt.Z,{slotKey:t})}),(0,B.tZ)(gt.Z,{children:o(`artifact:slotName:${t}`)})]},t)))]}))}var St=a(6480),kt=a(23690),Ct=a(13780);const Bt=["value","onChange","disabled","float"];function Kt(t){let{value:e,onChange:a,disabled:r=!1,float:i=!1}=t,l=(0,n.Z)(t,Bt);const[o,c]=(0,lt.useState)(""),s=(0,lt.useCallback)((()=>{if(""===o)return a(0);const t=i?parseFloat:parseInt;a(t(o))}),[a,o,i]);return(0,lt.useEffect)((()=>{var t;return c(null!=(t=null==e?void 0:e.toString())?t:"")}),[e,c]),(0,B.tZ)(Ct.Z,Object.assign({value:o,"aria-label":"custom-input",type:"number",onChange:t=>c(t.target.value),onBlur:s,disabled:r,onKeyDown:t=>"Enter"===t.key&&s()},l))}var Pt=a(79410),Rt=a(69698),At=a(4121),Dt=a(69614),Mt=a(80639),Xt=a(37942),Et=a(39099),It=a(30706),Lt=a(87833),Ft=a(12702),Ut=a(96580);function Gt({efficiency:t,max:e=!1,t:a,valid:n}){const r=e?"maxSubEff":"curSubEff";return(0,B.tZ)(Lt.Z,{sx:{py:1,px:2},children:(0,B.BX)(T.ZP,{container:!0,spacing:1,children:[(0,B.tZ)(T.ZP,{item:!0,children:a(`editor.${r}`)}),(0,B.tZ)(T.ZP,{item:!0,flexGrow:1,children:(0,B.tZ)(Ft.Z,{title:(0,B.BX)("span",{children:[(0,B.tZ)(tt.Z,{variant:"h6",children:a(`editor.${r}`)}),(0,B.tZ)(tt.Z,{children:(0,B.tZ)(ot.cC,{t:a,i18nKey:`editor.${r}Desc`})})]})})}),(0,B.tZ)(T.ZP,{item:!0,xs:"auto",children:(0,B.tZ)(Ut.Z,{valid:n,max:900,value:n?t:"ERR"})})]})})}var Ot=a(36081),Nt=a(89977),$t=a(12366),Wt=a(13900),Ht=a(25576);let _t,jt,zt,Vt,Tt,Yt,qt,Qt=t=>t;function Jt({index:t,artifact:e,setSubstat:a}){var n;const{t:l}=(0,ot.$G)("artifact"),{mainStatKey:o="",rarity:c=5}=null!=e?e:{},{key:s="",value:d=0,rolls:h=[],efficiency:u=0}=null!=(n=null==e?void 0:e.substats[t])?n:{},f=h.reduce(((t,e)=>t+e),0),m=Ht.ZP.unit(s),Z=h.length;let g="",p=[],y=0;if(e){const t=e.rarity,{numUpgrades:a,high:n}=r.i0[t];y=a+n-3-Z,p=s?(0,w.ME)(s,t):[]}const b=7-p.length;!Z&&s&&d&&(g=g||l(_t||(_t=Qt`editor.substat.error.noCalc`))),y<0&&(g=g||l("editor.substat.error.noOverRoll",{value:y+Z}));const x=(0,lt.useMemo)((()=>s?[{value:0},...(0,w.K_)(c,s).map((t=>({value:t})))]:[{value:0}]),[s,c]);return(0,B.BX)(Lt.Z,{children:[(0,B.tZ)(Y.Z,{sx:{display:"flex"},children:(0,B.BX)(q.Z,{size:"small",sx:{width:"100%",display:"flex"},children:[(0,B.BX)(ct.Z,{startIcon:s?(0,B.tZ)(Et.C,{statKey:s}):void 0,title:s?(0,B.tZ)(St.w0,{statKey:s}):l("editor.substat.substatFormat",{value:t+1}),disabled:!e,color:s?"success":"primary",sx:{whiteSpace:"nowrap"},children:[s&&(0,B.tZ)(et.Z,{onClick:()=>a(t,{key:"",value:0}),children:l(jt||(jt=Qt`editor.substat.noSubstat`))}),r._m.filter((t=>o!==t)).map((e=>(0,B.BX)(et.Z,{selected:s===e,disabled:s===e,onClick:()=>a(t,{key:e,value:0}),children:[(0,B.tZ)(Zt.Z,{children:(0,B.tZ)(Et.C,{statKey:e})}),(0,B.tZ)(gt.Z,{children:(0,B.tZ)(St.w0,{statKey:e})})]},e)))]}),(0,B.tZ)(Nt.CC,{sx:{flexBasis:30,flexGrow:1},children:(0,B.tZ)(Nt.ZP,{float:"%"===m,placeholder:l(zt||(zt=Qt`editor.substat.selectSub`)),value:s?d:void 0,onChange:e=>a(t,{key:s,value:null!=e?e:0}),disabled:!s,error:!!g,sx:{px:1},inputProps:{sx:{textAlign:"right"}}})}),!!p.length&&(0,B.tZ)(Wt.Z,{children:l(Vt||(Vt=Qt`editor.substat.nextRolls`))}),p.map(((e,n)=>{var r,l;let o=(0,w.Jj)(f+e,m);return o=null!=(r=null==(l=v.G2.art.subRollCorrection[c])||null==(l=l[s])?void 0:l[o])?r:o,(0,B.tZ)(Q.Z,{color:`roll${(0,i.re)(b+n,1,6)}`,disabled:d&&!Z||y<=0,onClick:()=>a(t,{key:s,value:parseFloat(o)}),children:o},n)}))]})}),(0,B.tZ)(Y.Z,{px:2,children:(0,B.tZ)(te,{value:d,marks:x,setValue:e=>{var n;return a(t,{key:s,value:null!=(n=e)?n:0})},disabled:!s})}),(0,B.tZ)(Y.Z,{sx:{px:1,pb:1},children:g?(0,B.tZ)($t.Z,{color:"error",children:l(Tt||(Tt=Qt`ui:error`))}):(0,B.BX)(T.ZP,{container:!0,children:[(0,B.tZ)(T.ZP,{item:!0,children:(0,B.tZ)($t.Z,{color:0===Z?"secondary":`roll${(0,i.re)(Z,1,6)}`,children:Z?l("editor.substat.RollCount",{count:Z}):l(Yt||(Yt=Qt`editor.substat.noRoll`))})}),(0,B.tZ)(T.ZP,{item:!0,flexGrow:1,children:!!h.length&&[...h].sort().map(((t,e)=>(0,B.tZ)(tt.Z,{component:"span",color:`roll${(0,i.re)(b+p.indexOf(t),1,6)}.main`,sx:{ml:1},children:(0,w.Jj)(t,m)},`${e}.${t}`)))}),(0,B.tZ)(T.ZP,{item:!0,xs:"auto",flexShrink:1,children:(0,B.tZ)(tt.Z,{children:(0,B.BX)(ot.cC,{t:l,i18nKey:"editor.substat.eff",color:"text.secondary",children:["Efficiency: ",(0,B.tZ)(Ut.Z,{valid:!0,max:100*Z,value:u||l(qt||(qt=Qt`editor.substat.noStat`))})]})})})]})})]})}function te({value:t,setValue:e,marks:a,disabled:n=!1}){var r,i;const[l,o]=(0,lt.useState)(t);return(0,lt.useEffect)((()=>o(t)),[t]),(0,B.tZ)(Ot.ZP,{value:l,step:null,disabled:n,marks:a,min:0,max:null!=(r=null==(i=a[a.length-1])?void 0:i.value)?r:0,onChange:(t,e)=>o(e),onChangeCommitted:(t,a)=>e(a),valueLabelDisplay:"auto"})}var ee=a(24264);const ae=a.p+"scanned.7fcdf3986bbc6101.png",ne=a.p+"fullscreen.093bacd265118df9.png";function re({modalShow:t,hide:e}){return(0,B.tZ)(Rt.Z,{open:t,onClose:e,children:(0,B.BX)(ee.Z,{children:[(0,B.tZ)(V.Z,{sx:{py:1},children:(0,B.BX)(T.ZP,{container:!0,children:[(0,B.tZ)(T.ZP,{item:!0,flexGrow:1,children:(0,B.tZ)(tt.Z,{variant:"subtitle1",children:"How to Upload Screenshots for parsing"})}),(0,B.tZ)(T.ZP,{item:!0,children:(0,B.tZ)(kt.Z,{onClick:e})})]})}),(0,B.tZ)(pt.Z,{}),(0,B.BX)(V.Z,{children:[(0,B.BX)(rt.Z,{variant:"outlined",severity:"warning",children:["NOTE: Artifact Scanning currently only works for"," ",(0,B.tZ)("strong",{children:"ENGLISH"})," artifacts."]}),(0,B.BX)(T.ZP,{container:!0,spacing:1,mt:1,children:[(0,B.tZ)(T.ZP,{item:!0,xs:8,md:6,children:(0,B.tZ)(Y.Z,{component:"img",alt:"snippet of the screen to take",src:ne,width:"100%",height:"auto"})}),(0,B.BX)(T.ZP,{item:!0,xs:12,md:6,children:[(0,B.tZ)(tt.Z,{gutterBottom:!0,children:"Using screenshots can dramatically decrease the amount of time you manually input in stats on the Genshin Optimizer."}),(0,B.tZ)(tt.Z,{variant:"h5",children:"Where to snip the screenshot."}),(0,B.BX)(tt.Z,{gutterBottom:!0,children:["In game, Open your bag, and navigate to the artifacts tab. Select the artifact you want to scan with Genshin Optimizer."," ",(0,B.tZ)("b",{children:"Only artifact from this screen can be scanned."})]}),(0,B.tZ)(tt.Z,{variant:"h6",children:"Single artifact"}),(0,B.BX)(tt.Z,{gutterBottom:!0,children:["To take a screenshot, in Windows, the shortcut is"," ",(0,B.tZ)("strong",{children:"Alt + Print Screen"}),". Once you selected the region, the image is automatically included in your clipboard."]}),(0,B.tZ)(tt.Z,{variant:"h6",children:"Multiple artifacts"}),(0,B.BX)(tt.Z,{gutterBottom:!0,children:["To take advantage of batch uploads, you can use a tool like"," ",(0,B.tZ)("a",{href:"https://picpick.app/",target:"_blank",rel:"noreferrer",children:"PicPick"})," ","to create a macro to easily to screenshot multiple artifacts at once."]}),(0,B.tZ)(tt.Z,{variant:"h5",children:"What to include in the screenshot."}),(0,B.tZ)(tt.Z,{children:"The full genshin window, or at least a region that covers the artifact card."})]}),(0,B.BX)(T.ZP,{item:!0,xs:12,md:7,children:[(0,B.tZ)(tt.Z,{variant:"h5",children:"Adding Screenshot to Genshin Optimizer"}),(0,B.tZ)(tt.Z,{children:"At this point, you should have the artifact screenshot either saved to your harddrive, or in your clipboard."}),(0,B.tZ)(tt.Z,{gutterBottom:!0,children:'You can click on the box next to "Browse" to browse the files in your harddrive for multiple screenshots.'}),(0,B.BX)(tt.Z,{children:["For single screenshots from the snippets, just press"," ",(0,B.tZ)("strong",{children:"Ctrl + V"})," to paste from your clipboard."]}),(0,B.BX)(tt.Z,{gutterBottom:!0,children:["You should be able to see a Preview of your artifact snippet, and after waiting a few seconds, the artifact set and the substats will be filled in in the ",(0,B.tZ)("b",{children:"Artifact Editor"}),"."]}),(0,B.tZ)(tt.Z,{variant:"h5",children:"Finishing the Artifact"}),(0,B.BX)(tt.Z,{children:["Unfortunately, computer vision is not 100%. There will always be cases where something is not scanned properly. You should always double check the scanned artifact values! Once the artifact has been filled, Click on ",(0,B.tZ)("strong",{children:"Add Artifact"})," to finish editing the artifact."]})]}),(0,B.tZ)(T.ZP,{item:!0,xs:8,md:5,children:(0,B.tZ)(Y.Z,{component:"img",alt:"main screen after importing stats",src:ae,width:"100%",height:"auto"})})]})]}),(0,B.tZ)(pt.Z,{}),(0,B.tZ)(V.Z,{sx:{py:1},children:(0,B.tZ)(kt.Z,{large:!0,onClick:e})})]})})}var ie=a(24370);const le=new i.eQ((async t=>{const e=(0,ie.createScheduler)(),a=Array(20).fill(0).map((async a=>{const n=await(0,ie.createWorker)(t,void 0,{errorHandler:console.error,langPath:"./assets"});e.addWorker(n)}));return await Promise.any(a),e}),((t,e)=>{e.then((t=>t.terminate()))}));async function oe(t,e=void 0){const a=h(t);return(await le.borrow("eng",(async t=>await(await t).addJob("recognize",a,e)))).data.lines.map((t=>t.text))}var ce=a(50090);const se=["artifact"];let de,he,ue,fe,me,Ze,ge,pe,ye,be,ve,xe,we,Se,ke=t=>t;const Ce=new Set(r._m);function Be(t,e){const a=(()=>{switch(e.type){case"reset":return;case"substat":{const{index:a,substat:n}=e,r=n.key?t.substats.findIndex((t=>t.key===n.key)):-1;return-1===r||r===a?t.substats[a]=n:[t.substats[a],t.substats[r]]=[t.substats[r],t.substats[a]],Object.assign({},t)}case"overwrite":return e.artifact;case"update":return Object.assign({},t,e.artifact)}})();return a?(0,Mt.BG)(a,!0):a}const Ke=(0,H.ZP)("input")({display:"none"});function Pe({artifactIdToEdit:t="",cancelEdit:e,allowUpload:a=!1,allowEmpty:l=!1,disableSet:o=!1,disableSlot:c=!1}){var s,d,h;const u=(0,lt.useRef)(new ScanningQueue(oe,!0)).current,{t:f}=(0,ot.$G)("artifact"),{database:m}=(0,lt.useContext)(Xt.t),[Z,g]=(0,lt.useState)(!1),[p,y]=(0,L.NW)();(0,lt.useEffect)((()=>m.arts.followAny(y)),[m,y]);const[b,v]=(0,lt.useReducer)(Be,void 0),[x,k]=(0,lt.useState)(!1),[{processedNum:C,outstandingNum:K,scanningNum:P},R]=(0,lt.useState)({processedNum:0,outstandingNum:0,scanningNum:0}),[A,D]=(0,lt.useState)(void 0),{fileName:M,imageURL:H,debugImgs:it,texts:st}=null!=A?A:{},dt=C+K+P,ht=!["new",""].includes(t)&&!(null==b||!b.location)||c,ut=(0,lt.useCallback)((t=>{t&&(g(!0),u.addFiles(Array.from(t).map((t=>({f:t,fName:t.name})))))}),[g,u]),Zt=(0,lt.useCallback)((()=>{u.clearQueue()}),[u]),gt=(0,lt.useCallback)((t=>{t.target&&(ut(t.target.files),t.target.value="")}),[ut]),{old:pt,oldType:yt}=(0,lt.useMemo)((()=>{var e;const a=p&&t&&m.arts.get(t);if(a)return{old:a,oldType:"edit"};if(void 0===b)return{old:void 0,oldType:""};const{duplicated:n,upgraded:r}=p&&m.arts.findDups(b);return{old:null!=(e=n[0])?e:r[0],oldType:0!==n.length?"duplicate":"upgrade"}}),[b,t,m,p]),{artifact:bt,errors:vt}=(0,lt.useMemo)((()=>{if(!b)return{artifact:void 0,errors:[]};return(0,Mt.m1)(b,t)}),[b,t]),xt=b?(0,At.Sk)(b.setKey):void 0,Ct=(0,lt.useCallback)((()=>{null==e||e(),v({type:"reset"}),D(void 0)}),[e,v]),Bt=(0,lt.useCallback)((t=>{var e,a;const n=t.setKey?(0,At.Sk)(t.setKey):xt;function l(t,e,a){return t&&e.includes(t)?t:null!=a?a:e[0]}t.setKey&&(t.rarity=l(null==b?void 0:b.rarity,n.rarity,Math.max(...n.rarity)),t.slotKey=l(null==b?void 0:b.slotKey,n.slots)),t.rarity&&(t.level=null!=(e=null==b?void 0:b.level)?e:0),t.level&&(t.level=(0,i.re)(t.level,0,4*(null!=(a=t.rarity)?a:b.rarity))),t.slotKey&&(t.mainStatKey=l(null==b?void 0:b.mainStatKey,r.yh[t.slotKey])),t.mainStatKey&&(t.substats=[0,1,2,3].map((e=>b&&b.substats[e].key!==t.mainStatKey?b.substats[e]:{key:"",value:0}))),v({type:"update",artifact:t})}),[b,xt,v]),Lt=(0,lt.useCallback)(((t,e)=>{v({type:"substat",index:t,substat:e})}),[v]),Ft=!vt.length,{rarity:Ut=5,level:Ot=0,slotKey:Nt="flower"}=null!=b?b:{},{currentEfficiency:$t=0,maxEfficiency:Wt=0}=bt?Dt.Z.getArtifactEfficiency(bt,Ce):{},Ht=(0,lt.useCallback)((e=>{t||!dt&&!b||window.confirm(f(he||(he=ke`editor.clearPrompt`)))?(g(!1),u.clearQueue(),Ct()):null==e||e.preventDefault()}),[f,t,u,b,dt,g,Ct]),_t=(0,_.Z)(),jt=(0,j.Z)(_t.breakpoints.up("md")),zt=b?r.fR.find((t=>b.mainStatKey.includes(t))):void 0,Vt=b?null!=zt?zt:"success":"primary",Tt=(0,lt.useCallback)((t=>Bt({setKey:t})),[Bt]),Yt=(0,lt.useCallback)((t=>""===t||!(!ht||"circlet"===Nt||"PrayersForDestiny"!==t&&"PrayersForIllumination"!==t&&"PrayersForWisdom"!==t&&"PrayersToSpringtime"!==t)),[ht,Nt]);return(0,lt.useEffect)((()=>{"new"===t&&(g(!0),v({type:"reset"}));const e=t&&p&&m.arts.get(t);e&&(g(!0),v({type:"overwrite",artifact:(0,i.I8)(e)}))}),[t,m,p]),(0,lt.useEffect)((()=>{if(!C||A)return;const t=u.shiftProcessed();if(!t)return;const{artifact:e}=t,a=(0,n.Z)(t,se);D(a),v({type:"overwrite",artifact:e})}),[u,C,A]),(0,lt.useEffect)((()=>{const t=t=>{var e;return ut(null==(e=t.clipboardData)?void 0:e.files)};return a&&window.addEventListener("paste",t),()=>{a&&window.removeEventListener("paste",t)}}),[ut,a]),(0,lt.useEffect)((()=>(u.callback=R,()=>{u.callback=()=>{}})),[u]),(0,B.tZ)(Rt.Z,{open:Z,onClose:Ht,children:(0,B.BX)(S.s8,{children:[(0,B.tZ)(re,{modalShow:x,hide:()=>k(!1)}),(0,B.tZ)(z.Z,{title:(0,B.tZ)(ot.cC,{t:f,i18nKey:"editor.title",children:"Artifact Editor"}),action:(0,B.tZ)(kt.Z,{disabled:!!dt,onClick:Ht})}),(0,B.BX)(V.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:[(0,B.BX)(T.ZP,{container:!0,spacing:1,columns:{xs:1,md:2},children:[(0,B.BX)(T.ZP,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[(0,B.BX)(Y.Z,{sx:{display:"flex",gap:1},children:[(0,B.tZ)(mt.Z,{disabled:o,size:"small",artSetKey:null!=(s=null==b?void 0:b.setKey)?s:"",setArtSetKey:Tt,sx:{flexGrow:1},label:null!=b&&b.setKey?"":f("editor.unknownSetName"),getOptionDisabled:({key:t})=>Yt(t)}),(0,B.tZ)(ft,{rarity:b?Ut:void 0,onChange:t=>Bt({rarity:t}),filter:t=>{var e;return!(null==xt||null==(e=xt.rarity)||null==e.includes||!e.includes(t))},disabled:!xt})]}),(0,B.BX)(Y.Z,{component:"div",display:"flex",children:[(0,B.tZ)(Kt,{id:"filled-basic",label:"Level",variant:"filled",sx:{flexShrink:1,flexGrow:1,mr:1,my:0},margin:"dense",size:"small",value:Ot,disabled:!xt,placeholder:"0~"+4*Ut,onChange:t=>Bt({level:t})}),(0,B.BX)(q.Z,{children:[(0,B.tZ)(Q.Z,{onClick:()=>Bt({level:Ot-1}),disabled:!xt||0===Ot,children:"-"}),Ut?[...Array(Ut+1).keys()].map((t=>4*t)).map((t=>(0,B.tZ)(Q.Z,{onClick:()=>Bt({level:t}),disabled:!xt||Ot===t,children:t},t))):null,(0,B.tZ)(Q.Z,{onClick:()=>Bt({level:Ot+1}),disabled:!xt||Ot===4*Ut,children:"+"})]})]}),(0,B.BX)(Y.Z,{component:"div",display:"flex",children:[(0,B.tZ)(wt,{disabled:ht||!xt||(null==b||null==(d=b.setKey)?void 0:d.startsWith("Prayer")),slotKey:Nt,onChange:t=>Bt({slotKey:t})}),(0,B.tZ)(S.s8,{bgt:"light",sx:{p:1,ml:1,flexGrow:1},children:(0,B.tZ)(lt.Suspense,{fallback:(0,B.tZ)(J.Z,{width:"60%"}),children:(0,B.tZ)(tt.Z,{color:"text.secondary",children:b&&null!=xt&&xt.getSlotName(b.slotKey)?(0,B.BX)("span",{children:[(0,B.tZ)(Pt.Z,{size:2,src:(0,X.Hp)(b.setKey,b.slotKey)}),null==xt?void 0:xt.getSlotName(b.slotKey)]}):f(ue||(ue=ke`editor.unknownPieceName`))})})})]}),(0,B.BX)(Y.Z,{component:"div",display:"flex",gap:1,children:[(0,B.tZ)(ct.Z,{startIcon:null!=b&&b.mainStatKey?(0,B.tZ)(Et.C,{statKey:b.mainStatKey}):void 0,title:(0,B.tZ)("b",{children:b?(0,B.tZ)(St.w0,{statKey:b.mainStatKey}):f(fe||(fe=ke`mainStat`))}),disabled:!xt,color:Vt,children:r.yh[Nt].map((t=>(0,B.tZ)(et.Z,{selected:(null==b?void 0:b.mainStatKey)===t,disabled:(null==b?void 0:b.mainStatKey)===t,onClick:()=>Bt({mainStatKey:t}),children:(0,B.tZ)(St.Rl,{statKey:t})},t)))}),(0,B.tZ)(S.s8,{bgt:"light",sx:{p:1,flexGrow:1},children:(0,B.tZ)(tt.Z,{color:"text.secondary",children:b?(0,w.R1)(b.mainStatKey,Ut,Ot):f(me||(me=ke`mainStat`))})}),(0,B.tZ)(Q.Z,{disabled:!b,onClick:()=>Bt({lock:!(null!=b&&b.lock)}),color:null!=b&&b.lock?"success":"primary",children:null!=b&&b.lock?(0,B.tZ)(E.Z,{}):(0,B.tZ)(I.Z,{})})]}),(0,B.tZ)(ce.W,{location:null!=(h=null==b?void 0:b.location)?h:"",setLocation:t=>Bt({location:t}),autoCompleteProps:{disabled:!b}}),(0,B.tZ)(Gt,{valid:Ft,efficiency:$t,t:f}),$t!==Wt&&(0,B.tZ)(Gt,{max:!0,valid:Ft,efficiency:Wt,t:f}),a&&(0,B.tZ)(S.s8,{bgt:"light",children:(0,B.tZ)(V.Z,{sx:{display:"flex",flexDirection:"column",gap:1},children:(0,B.BX)(lt.Suspense,{fallback:(0,B.tZ)(J.Z,{width:"100%",height:"100"}),children:[(0,B.BX)(T.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,B.tZ)(T.ZP,{item:!0,flexGrow:1,children:(0,B.BX)("label",{htmlFor:"contained-button-file",children:[(0,B.tZ)(Ke,{accept:"image/*",id:"contained-button-file",multiple:!0,type:"file",onChange:gt}),(0,B.tZ)(Q.Z,{component:"span",startIcon:(0,B.tZ)(F.Z,{}),children:"Upload Screenshot (or Ctrl-V)"})]})}),it&&(0,B.tZ)(T.ZP,{item:!0,children:(0,B.tZ)(Re,{imgs:it})}),(0,B.tZ)(T.ZP,{item:!0,children:(0,B.tZ)(Q.Z,{color:"info",sx:{px:2,minWidth:0},onClick:()=>k(!0),children:(0,B.tZ)(W.Z,{})})})]}),H&&(0,B.tZ)(Y.Z,{display:"flex",justifyContent:"center",children:(0,B.tZ)(Y.Z,{component:"img",src:H,width:"100%",maxWidth:350,height:"auto",alt:M||"Screenshot to parse for artifact values"})}),!!dt&&(0,B.tZ)(at.Z,{variant:"buffer",value:100*C/dt,valueBuffer:100*(C+P)/dt}),!!dt&&(0,B.tZ)(S.s8,{sx:{pl:2},children:(0,B.BX)(Y.Z,{display:"flex",alignItems:"center",children:[!!P&&(0,B.tZ)(nt.Z,{size:"1em"}),(0,B.tZ)(tt.Z,{sx:{flexGrow:1,ml:1},children:(0,B.BX)("span",{children:["Screenshots in file-queue:",(0,B.tZ)("b",{children:dt})]})}),(0,B.tZ)(Q.Z,{size:"small",color:"error",onClick:Zt,children:"Clear file-queue"})]})})]})})})]}),(0,B.BX)(T.ZP,{item:!0,xs:1,display:"flex",flexDirection:"column",gap:1,children:[[0,1,2,3].map((t=>(0,B.tZ)(Jt,{index:t,artifact:bt,setSubstat:Lt},t))),st&&(0,B.tZ)(S.s8,{bgt:"light",children:(0,B.BX)(V.Z,{children:[(0,B.tZ)("div",{children:st.slotKey}),(0,B.tZ)("div",{children:st.mainStatKey}),(0,B.tZ)("div",{children:st.mainStatVal}),(0,B.tZ)("div",{children:st.rarity}),(0,B.tZ)("div",{children:st.level}),(0,B.tZ)("div",{children:st.lock}),(0,B.tZ)("div",{children:st.substats}),(0,B.tZ)("div",{children:st.setKey}),(0,B.tZ)("div",{children:st.location})]})})]})]}),pt&&(0,B.BX)(T.ZP,{container:!0,sx:{justifyContent:"space-around"},spacing:1,children:[(0,B.tZ)(T.ZP,{item:!0,xs:12,md:5.5,lg:4,children:(0,B.BX)(S.s8,{bgt:"light",children:[(0,B.tZ)(tt.Z,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:f("edit"!==yt?"duplicate"===yt?Ze||(Ze=ke`editor.dupArt`):ge||(ge=ke`editor.upArt`):pe||(pe=ke`editor.beforeEdit`))}),(0,B.tZ)(It.Z,{artifactObj:pt})]})}),jt&&(0,B.tZ)(T.ZP,{item:!0,md:1,display:"flex",alignItems:"center",justifyContent:"center",children:(0,B.tZ)(S.s8,{bgt:"light",sx:{display:"flex"},children:(0,B.tZ)(U.Z,{sx:{fontSize:40}})})}),(0,B.tZ)(T.ZP,{item:!0,xs:12,md:5.5,lg:4,children:(0,B.BX)(S.s8,{bgt:"light",children:[(0,B.tZ)(tt.Z,{sx:{textAlign:"center"},py:1,variant:"h6",color:"text.secondary",children:f(ye||(ye=ke`editor.preview`))}),(0,B.tZ)(It.Z,{artifactObj:bt})]})})]}),!Ft&&(0,B.tZ)(rt.Z,{variant:"filled",severity:"error",children:vt.map(((t,e)=>(0,B.tZ)("div",{children:t},e)))}),(0,B.BX)(T.ZP,{container:!0,spacing:2,children:[(0,B.tZ)(T.ZP,{item:!0,children:"edit"===yt?(0,B.tZ)(Q.Z,{startIcon:(0,B.tZ)(G.Z,{}),onClick:()=>{b&&m.arts.set(pt.id,b),l||(g(!1),e()),Ct()},disabled:!b||!Ft,color:"primary",children:f(be||(be=ke`editor.btnSave`))}):(0,B.tZ)(Q.Z,{startIcon:(0,B.tZ)(G.Z,{}),onClick:()=>{m.arts.new(b),l||(g(!1),e()),Ct()},disabled:!b||!Ft,color:"duplicate"===yt?"warning":"primary",children:f(ve||(ve=ke`editor.btnAdd`))})}),(0,B.tZ)(T.ZP,{item:!0,flexGrow:1,children:l&&(0,B.tZ)(Q.Z,{startIcon:(0,B.tZ)(O.Z,{}),disabled:!b,onClick:()=>{window.confirm(f(de||(de=ke`editor.clearPrompt`)))&&Ct()},color:"error",children:f(xe||(xe=ke`editor.btnClear`))})}),(0,B.tZ)(T.ZP,{item:!0,children:(0,B.tZ)(Q.Z,{color:"info",startIcon:(0,B.tZ)(N.Z,{}),onClick:()=>v({type:"overwrite",artifact:(0,w.Ah)()}),children:f(we||(we=ke`editor.btnRandom`))})}),pt&&"edit"!==yt&&(0,B.tZ)(T.ZP,{item:!0,children:(0,B.tZ)(Q.Z,{startIcon:(0,B.tZ)($.Z,{}),onClick:()=>{b&&m.arts.set(pt.id,b),l?Ct():g(!1)},disabled:!b||!Ft,color:"success",children:f(Se||(Se=ke`editor.btnUpdate`))})})]})]})]})})}function Re({imgs:t}){const[e,a]=(0,lt.useState)(!1);return(0,B.BX)(B.HY,{children:[(0,B.tZ)(Q.Z,{color:"warning",onClick:()=>a(!0),children:"DEBUG"}),(0,B.tZ)(Rt.Z,{open:e,onClose:()=>a(!1),children:(0,B.tZ)(S.s8,{children:(0,B.tZ)(V.Z,{children:(0,B.tZ)(it.Z,{spacing:1,children:Object.entries(t).map((([t,e])=>(0,B.BX)(Y.Z,{children:[(0,B.tZ)(tt.Z,{children:t}),(0,B.tZ)(Y.Z,{component:"img",src:e,maxWidth:"100%"})]},t)))})})})})]})}}}]);